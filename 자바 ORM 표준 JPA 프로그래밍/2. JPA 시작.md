## 1. ì¸í…”ë¦¬ì œì´ ì„¤ì¹˜ì™€ í”„ë¡œì íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°

ì¸ì ¤ë¦¬ì œì´ ì„¤ì¹˜ëŠ” [ì´ê³³](https://www.jetbrains.com/ko-kr/idea/)ì—ì„œ í•  ìˆ˜ ìˆë‹¤. í•™ìƒì´ë©´ **Ultimate **ë²„ì „ì„ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆë‹¤.

ì¸í…”ë¦¬ì œì´ë¥¼ ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆë‹¤.

![image](https://images.velog.io/images/tigger/post/1c0032ad-89b1-45db-a6b2-708f2eeb5c4d/image.png)

ë°‘ì— `Get from Version Control`ì„ í´ë¦­í•´ë³´ì.

![image](https://images.velog.io/images/tigger/post/627fa0a7-45a7-4d22-b624-b5bf496d6cec/image.png)

í•´ë‹¹ gitì£¼ì†Œë¥¼ ì…ë ¥í•œë‹¤ìŒ cloneì„ ëˆ„ë¥¸ë‹¤.

![image](https://images.velog.io/images/tigger/post/ae4ab3ba-5c19-42c2-bd32-d94682dc99ab/image.png)

ì´ë ‡ê²Œ í”„ë¡œì íŠ¸ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.

## 2. H2 ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì¹˜

[H2 Database Engine](https://www.h2database.com/html/main.html) í™ˆí˜ì´ì§€ì—ì„œ Platform-Independent Zip(Last Stable)ì„ ë‹¤ìš´ë°›ì•„ì„œ ì„¤ì¹˜í•˜ì.

ì‹¤í–‰ì‹œí‚¤ëŠ” ë°©ë²•ì€ í´ë” ì•ˆì— bin í´ë”ê°€ ìˆë‹¤. bin í´ë”ì•ˆì— ìˆëŠ” jar íŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¤ë©´ H2 ì›¹ ë¸Œë¼ìš°ì € í™”ë©´ì„ ë³¼ ìˆ˜ ìˆë‹¤.

![image](https://images.velog.io/images/tigger/post/2bf64a2c-2dab-4761-9036-261e086b333a/image.png)

í™”ë©´ì´ ë‚˜ì™”ìœ¼ë©´ ì‹¤í–‰ì„ í•´ë³´ì.

![image](https://images.velog.io/images/tigger/post/9cb4bf25-5568-4df3-8a54-c6477a77c0e7/image.png)

ì±…ì„ ë³´ê³  ë”°ë¼ í–ˆì§€ë§Œ ì´ëŸ° ì˜¤ë¥˜ê°€ ë‚˜ì™”ë‹¤.ğŸ¤” ë¬´ì—‡ì´ ë¬¸ì œì¼ê¹Œ? ê°„ë‹¨íˆ ë§í•˜ë©´ í•´ë‹¹ ê²½ë¡œì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—°ê²° ì‹œë„í•´ì„œ ë‚˜íƒ€ë‚˜ëŠ” ì˜¤ë¥˜ì´ë‹¤. ê·¸ëŸ¼ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì–´ë–»ê²Œ ë§Œë“¤ê¹Œ? í•œë²ˆ ë§Œë“¤ì–´ë³´ì. ìš°ì„  ë°‘ì— ê·¸ë¦¼ê³¼ ê°™ì´ ì„¤ì •í•˜ê³  ì‹¤í–‰í•œë‹¤.

![image](https://images.velog.io/images/tigger/post/776dd1c1-3248-4ac4-8e76-f96e8c517361/image.png)

í•´ë‹¹ ê²½ë¡œì— `test.mv.db`ë¼ëŠ” íŒŒì¼ì´ ìƒì„±ëœë‹¤. ê·¸ëŸ¼ ë‹¤ì‹œ ë°‘ì— ê·¸ë¦¼ê³¼ ê°™ì´ Serverë¡œ ì„¤ì •í•˜ê³  ì‹¤í–‰í•œë‹¤.

![image](https://images.velog.io/images/tigger/post/2bf64a2c-2dab-4761-9036-261e086b333a/image.png)

ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤. ë‹¤ìŒê³¼ ê°™ì€ í™”ë©´ì´ ë‚˜ì˜¤ë©´ ì„±ê³µì´ë‹¤.

![image](https://images.velog.io/images/tigger/post/bdf052ab-f7f2-49e5-bba7-d486a8c0da22/image.png)

ê·¸ëŸ¼ ì´ì œ í…Œì´ë¸”ì„ ë§Œë“¤ì–´ë³´ì. ë°‘ì— ê·¸ë¦¼ì²˜ëŸ¼ SQLì„ ì…ë ¥í•˜ê³  ì‹¤í–‰í•˜ë©´ ì™¼ìª½ì— MEMBER í…Œì´ë¸”ì´ ìƒì„±ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

![image](https://images.velog.io/images/tigger/post/1ab78b2f-b589-488e-a017-feef1726048d/image.png)

## 3. ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ í”„ë¡œì íŠ¸ êµ¬ì¡°

### Gradleê³¼ ì‚¬ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ ê´€ë¦¬

ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” Gradleì´ ê´€ë¦¬í•´ì£¼ê³  ìˆë‹¤. Mavenë„ ìˆì§€ë§Œ Gradleì„ ì‚¬ìš©í•´ì„œ ì‹¤ìŠµí•˜ëŠ” ì´ìœ ëŠ” ê°„ë‹¨í•˜ê³  ê°€ë…ì„±ì´ ì¢‹ê¸° ë•Œë¬¸ì´ë‹¤. (Mavenì˜ ë‹¨ì ì„ ë³´ì™„í•œ íˆ´)

build.gradleë¡œ ê°€ë³´ì.

```java
plugins {
    id 'java'
}

group 'org.example'
version '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

dependencies {
    compile group: 'org.hibernate', name: 'hibernate-gradle-plugin', version: '5.4.26.Final'
    compile group: 'com.h2database', name: 'h2', version: '1.4.200'
}
```

`dependencies`ì— ì‚¬ìš©í•  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì§€ì •í•œë‹¤. ì›í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” [ì´ê³³](https://mvnrepository.com/)ì—ì„œ ê²€ìƒ‰í•˜ë©´ ì°¾ì„ ìˆ˜ ìˆë‹¤.

### í”„ë¡œì íŠ¸ êµ¬ì¡°

í”„ë¡œì íŠ¸ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë˜ì–´ìˆë‹¤.

```
src/main
â”œ java
â”‚	â”” jpastudy/start
â”‚		â”œ JpaMain.java (ì‹¤í–‰ í´ë˜ìŠ¤)
â”‚		â”” Member.java (íšŒì› í´ë˜ìŠ¤)
â”œ resources
â”‚	â”” META-INF
â”‚		â”” persistence.xml (JPA ì„¤ì • ì •ë³´)
build.gradle
```

## 4. ê°ì²´ ë§¤í•‘ ì‹œì‘

H2 ë°ì´í„°ë² ì´ìŠ¤ì— MEMBER í…Œì´ë¸”ì„ ìƒì„±í–ˆë‹¤.

```SQL
CREATE TABLE MEMBER (
    ID VARCHAR(255) NOT NULL, --ì•„ì´ë””(ê¸°ë³¸ í‚¤)
    NAME VARCHAR(255),        --ì´ë¦„
    AGE INTEGER NOT NULL,     --ë‚˜ì´
    PRIMARY KEY (ID)
)
```

ì´ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•  Member í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ë³´ì.

```java
package jpastudy.start;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.Table;

@Entity
@Table(name="MEMBER")
public class Member {

    @Id
    @Column(name = "ID")
    private String id;

    @Column(name = "NAME")
    private String username;

    // ë§¤í•‘ ì •ë³´ê°€ ì—†ëŠ” í•„ë“œ
    private Integer age;

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public Integer getAge() {
        return age;
    }

    public void setAge(Integer age) {
        this.age = age;
    }
}

```

![image](https://images.velog.io/images/tigger/post/d788d34e-61c8-4213-ace0-5d7139848fb1/image.png)

@Entity, @Table, @Columnì€ ë§¤í•‘ ì •ë³´ë‹¤. JPAëŠ” ë§¤í•‘ ì–´ë…¸í…Œì´ì…˜ì„ ë¶„ì„í•´ì„œ ì–´ë–¤ ê°ì²´ê°€ ì–´ë–¤ í…Œì´ë¸”ê³¼ ê´€ê³„ê°€ ìˆëŠ”ì§€ ì•Œì•„ë‚¸ë‹¤. Member í´ë˜ìŠ¤ë¡œ ì˜ˆë¥¼ ë“¤ì–´ ë³´ì.

**@Entity**

- ì´ í´ë˜ìŠ¤ë¥¼ í…Œì´ë¸”ê³¼ ë§¤í•‘í•œë‹¤ê³  JPAì—ê²Œ ì•Œë ¤ì¤€ë‹¤.

**@Table**

- ì—”í‹°í‹° í´ë˜ìŠ¤ì— ë§¤í•‘í•  í…Œì´ë¸” ì •ë³´ë¥¼ ì•Œë ¤ì¤€ë‹¤. name ì†ì„±ì„ ì‚¬ìš©í•´ì„œ Member ì—”í‹°í‹°ë¥¼ MEMBER í…Œì´ë¸”ì— ë§¤í•‘í–ˆë‹¤. ë§Œì•½ ì–´ë…¸í…Œì´ì…˜ì„ ìƒëµí•˜ë©´ í´ë˜ìŠ¤ ì´ë¦„ìœ¼ë¡œ ë§¤í•‘í•œë‹¤.

**@Id**

- ì—”í‹°í‹° í´ë˜ìŠ¤ì˜ í•„ë“œë¥¼ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤(Primary key)ì— ë§¤í•‘í•œë‹¤. ì˜ˆì‹œì²˜ëŸ¼ @Idê°€ ì‚¬ìš©ëœ í•„ë“œë¥¼ ì‹ë³„ì í•„ë“œë¼ê³  í•œë‹¤.

**@Column**

- í•„ë“œë¥¼ ì»¬ëŸ¼ì— ë§¤í•‘í•œë‹¤. `username` í•„ë“œì˜ ê²½ìš° name ì†ì„±ì„ ì‚¬ìš©í•´ì„œ MEMBER í…Œì´ë¸”ì˜ NAME ì»¬ëŸ¼ì— ë§¤í•‘í–ˆë‹¤.

**ë§¤í•‘ ì •ë³´ê°€ ì—†ëŠ” í•„ë“œ**

- `age` í•ƒë“œëŠ” ë§¤í•‘ ì–´ë…¸í…Œì´ì…˜ì´ ì—†ë‹¤. ì´ë ‡ê²Œ ìƒëµí•˜ë©´ í•„ë“œëª…ì„ ì‚¬ìš©í•´ì„œ ì»¬ëŸ¼ëª…ì„ ë§¤í•‘í•œë‹¤. ë§Œì•½ ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•œë‹¤ë©´ `username`ì²˜ëŸ¼ ëª…ì‹œí•´ì•¼í•œë‹¤.

## 5. persistence.xml ì„¤ì •

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!-- xmlns, version ëª…ì‹œ -->
<persistence xmlns="http://xmlns.jcp.org/xml/ns/persistence" version="2.1">

    <!-- ì˜ì†ì„± ìœ ë‹› ë“±ë¡ -->
    <persistence-unit name="jpastudy">
        <!-- ì—”í‹°í‹° í´ë˜ìŠ¤ ì§€ì • -->
        <class>jpastudy.start.Member</class>
        <properties>
            <!-- í•„ìˆ˜ ì†ì„± -->
            <!-- JPA í‘œì¤€ ì†ì„± -->
            <property name="javax.persistence.jdbc.driver" value="org.h2.Driver"/>
            <property name="javax.persistence.jdbc.user" value="sa"/>
            <property name="javax.persistence.jdbc.password" value=""/>
            <property name="javax.persistence.jdbc.url" value="jdbc:h2:tcp://localhost/~/test"/>
            <property name="hibernate.dialect" value="org.hibernate.dialect.H2Dialect" />

            <!-- ì˜µì…˜ -->
            <!-- í•˜ì´ë²„ë„¤ì´íŠ¸ ì†ì„± -->
            <property name="hibernate.show_sql" value="true" />
            <property name="hibernate.format_sql" value="true" />
            <property name="hibernate.use_sql_comments" value="true" />
            <property name="hibernate.id.new_generator_mappings" value="true" />

            <!--<property name="hibernate.hbm2ddl.auto" value="create" />-->
        </properties>
    </persistence-unit>

</persistence>
```

### ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸

JPAëŠ” íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ì— ì¢…ì†ì ì´ì§€ ì•Šì€ ê¸°ìˆ ì´ë‹¤. ë”°ë¼ì„œ ë‹¤ë¥¸ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì‰½ê²Œ êµì²´í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ°ë° ë°ì´í„°ë² ì´ìŠ¤ë§ˆë‹¤ ì œê³µí•˜ëŠ” SQL ë¬¸ë²•ê³¼ í•¨ìˆ˜ê°€ ì¡°ê¸ˆì”© ë‹¤ë¥´ë‹¤.

**ê°€ë³€ ë¬¸ì íƒ€ì…**

- MySQL - VARCHAR
- ì˜¤ë¼í´ - VARCHAR2

**ë¬¸ìì—´ ìë¥´ëŠ” í•¨ìˆ˜**

- SQL í‘œì¤€ - SUBSTRING()
- ì˜¤ë¼í´ - SUBSTR()

**í˜ì´ì§• ì²˜ë¦¬**

- MySQL - LIMIT
- ì˜¤ë¼í´ - ROWNUM

ì´ì²˜ëŸ¼ SQL í‘œì¤€ì„ ì§€í‚¤ì§€ ì•Šê±°ë‚˜ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ë§Œì˜ ê³ ìœ í•œ ê¸°ëŠ¥ì„ JPAì—ì„œëŠ” ë°©ì–¸(Dialect)ë¼ê³  í•œë‹¤. í•˜ì§€ë§Œ í•˜ì´ë²„ë„¤ì´íŠ¸ë¥¼ í¬í•¨í•œ ëŒ€ë¶€ë¶„ì˜ JPA êµ¬í˜„ì²´ë“¤ì€ ë‹¤ì–‘í•œ ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸ í´ë˜ìŠ¤ë¥¼ ì œê³µí•œë‹¤.

## 6. ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ

**ì½”ë“œ êµ¬ì„±**

- ì—”í‹°í‹° ë©”ë‹ˆì € ì„¤ì •
- íŠ¸ëœì ì…˜ ê´€ë¦¬
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

```java
package jpastudy.start;

import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.EntityTransaction;
import javax.persistence.Persistence;

public class JpaMain {

    public static void main(String[] args) {

        //ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ìƒì„±
        EntityManagerFactory emf = Persistence.createEntityManagerFactory("jpastudy");
        EntityManager em = emf.createEntityManager(); //ì—”í‹°í‹° ë§¤ë‹ˆì € ìƒì„±

        EntityTransaction tx = em.getTransaction(); //íŠ¸ëœì­ì…˜ ê¸°ëŠ¥ íšë“

        try {
            tx.begin(); //íŠ¸ëœì­ì…˜ ì‹œì‘
            logic(em);  //ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
            tx.commit();//íŠ¸ëœì­ì…˜ ì»¤ë°‹

        } catch (Exception e) {
            e.printStackTrace();
            tx.rollback(); //íŠ¸ëœì­ì…˜ ë¡¤ë°±
        } finally {
            em.close(); //ì—”í‹°í‹° ë§¤ë‹ˆì € ì¢…ë£Œ
        }

        emf.close(); //ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ì¢…ë£Œ
    }

    public static void logic(EntityManager em) {

        String id = "id1";
        Member member = new Member();
        member.setId(id);
        member.setUsername("ì§€í•œ");
        member.setAge(2);

        //ë“±ë¡
        em.persist(member);

        //ìˆ˜ì •
        member.setAge(20);

        //í•œ ê±´ ì¡°íšŒ
        Member findMember = em.find(Member.class, id);
        System.out.println("findMember=" + findMember.getUsername() + ", age=" + findMember.getAge());

        //ëª©ë¡ ì¡°íšŒ
        List<Member> members = em.createQuery("select m from Member m", Member.class).getResultList();
        System.out.println("members.size=" + members.size());

        //ì‚­ì œ
        em.remove(member);
    }
}
```

### 1. ì—”í‹°í‹° ë©”ë‹ˆì € ì„¤ì •

![image](https://images.velog.io/images/tigger/post/e68b7ade-b063-432d-acb0-2204698436c9/image.png)

**ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ìƒì„±**

- persistence.xmlì˜ ì„¤ì • ì •ë³´ë¥¼ ì‚¬ìš©í•´ì„œ ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ìƒì„±
- Persistence í´ë˜ìŠ¤ ì‚¬ìš©(ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ë¥¼ ìƒì„±í•´ì„œ JPAë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ì¤€ë¹„í•¨ )

```java
EntityManagerFactory emf = Persistence.createEntityManagerFactory("jpastudy");
```

- META-INF/persistence.xmlì—ì„œ ì´ë¦„ì´ jpastudyì¸ ì˜ì†ì„± ìœ ë‹›ì„ ì°¾ì•„ì„œ ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ìƒì„±

> persistence.xmlì˜ ì„¤ì • ì •ë³´ë¥¼ ì½ì–´ì„œ JPAë¥¼ ë™ì‘ì‹œí‚¤ê¸° ìœ„í•œ ê¸°ë°˜ ê°ì²´ë¥¼ ë§Œë“¤ê³  JPA êµ¬í˜„ì²´ì— ë”°ë¼ì„œëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ í’€ë„ ìƒì„±í•˜ë¯€ë¡œ ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ë¥¼ ìƒì„±í•˜ëŠ” ë¹„ìš©ì€ ì•„ì£¼ í¬ë‹¤. ë”°ë¼ì„œ **ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì—ì„œ ë”± í•œ ë²ˆë§Œ ìƒì„±í•˜ê³  ê³µìœ í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.**

**ì—”í‹°í‹° ë§¤ë‹ˆì € ìƒì„±**

```java
EntityManager em = emf.createEntityManager();
```

- JPA ëŒ€ë¶€ë¶„ì˜ ê¸°ëŠ¥ ì œê³µ
- ë“±ë¡/ìˆ˜ì •/ì‚­ì œ/ì¡°íšŒ ê°€ëŠ¥
- ë‚´ë¶€ì— ë°ì´í„°ì†ŒìŠ¤(ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜)ë¥¼ ìœ ì§€í•˜ë©´ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ í†µì‹ (ê°œë°œìëŠ” ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ê°€ìƒì˜ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ìƒê°í•  ìˆ˜ ìˆìŒ)

> ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ê³¼ ë°€ì ‘í•œ ê´€ê³„ê°€ ìˆìœ¼ë¯€ë¡œ ìŠ¤ë ˆë“œê°„ì— ê³µìœ í•˜ê±°ë‚˜ ì¬ì‚¬ìš©í•˜ë©´ ì•ˆ ëœë‹¤. 

**ì¢…ë£Œ**

```java
// ë§ˆì§€ë§‰ìœ¼ë¡œ ì‚¬ìš©ì´ ëë‚œ ì—”í‹°í‹° ë§¤ë‹ˆì € ì¢…ë£Œ(ë°˜ë“œì‹œ)
em.close(); // ì—”í‹°í‹° ë§¤ë‹ˆì € ì¢…ë£Œ

// ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œí•  ë•Œ ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ì¢…ë£Œ
emf.close(); // ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ ì¢…ë£Œ
```

### 2. íŠ¸ëœì ì…˜ ê´€ë¦¬

- JPAë¥¼ ì‚¬ìš©í•˜ë©´ ìƒí•­ íŠ¸ëœì ì…˜ ì•ˆì—ì„œ ë°ì´í„°ë¥¼ ë³€ê²½í•´ì•¼ í•œë‹¤(íŠ¸ëœì ì…˜ ì—†ì´ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ë©´ ì˜ˆì™¸ê°€ ë°œìƒ).
- íŠ¸ëœì ì…˜ì„ ì‹œì‘í•˜ë ¤ë©´ ì—”í‹°í‹° ë§¤ë‹ˆì €ì—ì„œ íŠ¸ëœì ì…˜ APIë¥¼ ë°›ì•„ì™€ì•¼ í•œë‹¤.

```java
EntityTransaction tx = em.getTransaction(); //íŠ¸ëœì­ì…˜ API

try {
    tx.begin(); //íŠ¸ëœì­ì…˜ ì‹œì‘
    logic(em);  //ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
    tx.commit();//íŠ¸ëœì­ì…˜ ì»¤ë°‹

} catch (Exception e) {
    e.printStackTrace();
    tx.rollback(); //ì˜ˆì™¸ ë°œìƒ ì‹œ íŠ¸ëœì­ì…˜ ë¡¤ë°±
}
```

### 3. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

```java
public static void logic(EntityManager em) {

    String id = "id1";
    // ì—”í‹°í‹° ìƒì„±
    Member member = new Member();
    member.setId(id);
    member.setUsername("ì§€í•œ");
    member.setAge(2);

    //ë“±ë¡
    em.persist(member);

    //ìˆ˜ì •
    member.setAge(20);

    //í•œ ê±´ ì¡°íšŒ
    Member findMember = em.find(Member.class, id);
    System.out.println("findMember=" + findMember.getUsername() + ", age=" + findMember.getAge());

    //ëª©ë¡ ì¡°íšŒ
    List<Member> members = em.createQuery("select m from Member m", Member.class).getResultList();
    System.out.println("members.size=" + members.size());

    //ì‚­ì œ
    em.remove(member);
}
```

ë¡œì§ì„ ë³´ë©´ CRUD ì‘ì—…ì´ ì—”í‹°í‹° ë©”ë‹ˆì €(em)ì— ì˜í•´ ì§„í–‰ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

**ë“±ë¡**

```java
em.persist(member);
```

- ì—”í‹°í‹° ë§¤ë‹ˆì €ì˜ `persist()` ë©”ì†Œë“œì— ì €ì¥í•  ì—”í‹°í‹°ë¥¼ ì¸ìë¡œ ë„£ì–´ì¤€ë‹¤.
- JPAê°€ Member ì—”í‹°í‹°ì˜ ë§¤í•‘ ì •ë³´ë¥¼ ë¶„ì„í•´ì„œ ë‹¤ìŒê³¼ ê°™ì€ SQLì„ ë§Œë“¤ì–´ ì „ë‹¬í•œë‹¤.

ê·¸ë¦¼ì€ ìœ„ì—ì„œ ì„¤ì •í•œ í•˜ì´ë²„ë„¤ì´íŠ¸ ì„¤ì •(persistence.xml)ìœ¼ë¡œ í„°ë¯¸ë„ì— ë„ìš¸ ìˆ˜ ìˆë‹¤.

![image](https://images.velog.io/images/tigger/post/d7af5f94-3eda-4e05-ab04-ad4479e7de3b/image.png)

**ìˆ˜ì •**

```java
member.setAge(20);
```

ì—¬ê¸°ì„œ ì˜ë¬¸ì´ ìˆë‹¤. ìˆ˜ì •ì€ ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ì‚¬ìš© ì•ˆ í•˜ëŠ” ê²ƒì¼ê¹Œ? JPAëŠ” ì–´ë–¤ ì—”í‹°í‹°ê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€ ì¶”ì í•˜ëŠ” ê¸°ëŠ¥ì„ ê°–ì¶”ê³  ìˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ 3ì¥(ì˜ì†ì„± ê´€ë¦¬)ì—ì„œ ë‹¤ë£¬ë‹¤.

![image](https://images.velog.io/images/tigger/post/49c10ff4-025c-45c2-b115-d7fb5d2101f2/image.png)

**í•œ ê±´ ì¡°íšŒ**

```java
Member findMember = em.find(Member.class, id);
System.out.println("findMember=" + findMember.getUsername() + ", age=" + findMember.getAge());
```

@Idë¡œ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ì™€ ë§¤í•‘í•œ ì‹ë³„ì ê°’ìœ¼ë¡œ ì—”í‹°í‹° í•˜ë‚˜ë¥¼ ì¡°íšŒí•œë‹¤. ì™œ ì´ ë¡œì§ì€ ì‹¤í–‰ë  ë•Œ ì¿¼ë¦¬ë¬¸ì„ ì•ˆ ë³´ë‚¼ê¹Œ? ê·¸ê²ƒë„ ë¬¼ë¡  3ì¥(ì˜ì†ì„± ê´€ë¦¬)ì—ì„œ ì´ì•¼ê¸°í•œë‹¤.

**ì‚­ì œ**

```java
em.remove(member);
```

ì—”í‹°í‹°ë¥¼ ì‚­ì œí•˜ë ¤ë©´ ì—”í‹°í‹° ë§¤ë‹ˆì €ì˜ `remove()` ë©”ì„œë“œì— ì‚­ì œí•˜ë ¤ëŠ” ì—”í‹°í‹°ë¥¼ ì¸ìë¡œ ë„£ì–´ì¤€ë‹¤.

![image](https://images.velog.io/images/tigger/post/ea796488-d668-4739-9dc2-e8f3d579319d/image.png)

## 4. JPQL

ìœ„ì—ì„œ ëª©ë¡ ì¡°íšŒì— ëŒ€í•œ ì„¤ëª…ì´ ì—†ì—ˆì„ ê²ƒì´ë‹¤. ì™œì¼ê¹Œ? í•´ë‹¹ ì˜ˆì‹œëŠ” JPQLì„ ì‚¬ìš©í•˜ì—¬ ëª©ë¡ì„ ì¡°íšŒí–ˆê¸° ë•Œë¬¸ì´ë‹¤. í•´ë‹¹ ì˜ˆì‹œëŠ” JPQLì„ ì‚¬ìš©í•˜ì—¬ í•˜ë‚˜ ì´ìƒì˜ Member ëª©ë¡ì„ ì¡°íšŒí•œ ë¡œì§ì´ë‹¤.

```java
List<Member> members = em.createQuery("select m from Member m", Member.class).getResultList();
    System.out.println("members.size=" + members.size());
```

ê·¸ëŸ¼ JPQL(Java Persistence Query Language)ì´ ë¬´ì—‡ì¼ê¹Œ? JPQLì€ SQLì„ ì¶”ìƒí™”í•œ ê°ì²´ ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ì´ë‹¤. ê·¸ë¦¬ê³  JPAëŠ” JPQLì„ ì‚¬ìš©í•œë‹¤.

ì™œ JPQLì„ ì‚¬ìš©í• ê¹Œ? ì´ì œê¹Œì§€ ì˜ˆì‹œ(CRUD)ë¥¼ ë³´ë©´ SQL ë¬¸ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ë‹¤. í•˜ì§€ë§Œ ë¬¸ì œëŠ” ê²€ìƒ‰ ì¿¼ë¦¬ë‹¤. JPAëŠ” ì—”í‹°í‹° ê°ì²´ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ê°œë°œí•˜ë¯€ë¡œ ê²€ìƒ‰í•  ë•Œë„ í…Œì´ë¸”ì´ ì•„ë‹Œ ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ê²€ìƒ‰í•´ì•¼ í•œë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì˜ ëª¨ë“  ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¨ ë‹¤ìŒ ê°ì²´ë¡œ ë§Œë“¤ì–´ ê²€ìƒ‰í•˜ëŠ” ê±´ í˜„ì‹¤ì„±ì´ ì—†ë‹¤. ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•´ ì£¼ëŠ” ì¿¼ë¦¬ ì–¸ì–´ê°€ JPQLì´ë‹¤. ë¬¸ë²•ë„ SQLê³¼ ìœ ì‚¬í•˜ë‹¤. 

ê·¸ëŸ¬ë©´ ì°¨ì´ì ì€ ë¬´ì—‡ì¼ê¹Œ? 

**ì°¨ì´ì **

- JPQL - ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬(í´ë˜ìŠ¤ì™€ í•„ë“œ ëŒ€ìƒ)
- SQL - ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì„ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬

JPQLì„ ì‚¬ìš©í•˜ë ¤ë©´ `em.createQuery(JPQL, ë°˜í™˜ íƒ€ì…)` ë©”ì„œë“œë¥¼ ì‹¤í–‰í•´ì„œ ì¿¼ë¦¬ ê°ì²´ë¥¼ ìƒì„±í•œ í›„ ì¿¼ë¦¬ ê°ì²´ì˜ `getResultList()` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ëœë‹¤.

ì˜ˆì œì—ì„œ ì‚¬ìš©í•œ `select m from Member m` ì´ê²ƒì´ JPQLì´ë‹¤. ì—¬ê¸°ì„œ MemberëŠ” í…Œì´ë¸”ì´ ì•„ë‹Œ Member ê°ì²´ë‹¤. ë‹¤ìŒ ê·¸ë¦¼ê³¼ ê°™ì´ JPAëŠ” JPQLì„ ë¶„ì„í•˜ê³  ì ì ˆí•œ SQLì„ ë§Œë“¤ì–´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°íšŒí•œë‹¤.

![image](https://images.velog.io/images/tigger/post/2819f4b1-15a8-4590-b17d-86c05fae83fb/image.png)